# Created by: Lucas Krupinski
# Email: lucasjkr@me.com
# Last modified: September 2017
#
# Assign "type" to incoming BRO data based on the log source field accompanying the data

filter {

  if "conn.log" in [source] {
    mutate {
      replace => { 
        "type" => "bro_conn" 
      }

# Only need to track logstash step in dev, disabled in prod
#      add_field => { "logstash-step" => "1002_tagged_by_source" }

    }
  }

  if "dhcp.log" in [source] {
    mutate { 
      replace => { 
        "type" => "bro_dhcp" 
      }

# Only need to track logstash step in dev, disabled in prod
#      add_field => { "logstash-step" => "1002_tagged_by_source" }

    }
  }

  if "dns.log" in [source] {
    mutate {
      replace => { 
        "type" => "bro_dns"
      }

# Only need to track logstash step in dev, disabled in prod
#      add_field => { "logstash-step" => "1002_tagged_by_source" }

    }
  }

  if "files.log" in [source] {
    mutate {
      replace => {
        "type" => "bro_files" 
      }

# Only need to track logstash step in dev, disabled in prod
#      add_field => { "logstash-step" => "1002_tagged_by_source" }

    }
  }

  if "ftp.log" in [source] {
    mutate {
      replace => { 
        "type" => "bro_ftp"
      }

# Only need to track logstash step in dev, disabled in prod
#      add_field => { "logstash-step" => "1002_tagged_by_source" }

    }
  }

  if "http.log" in [source] {
    mutate {
      replace => { 
        "type" => "bro_http" 
      }

# Only need to track logstash step in dev, disabled in prod
#      add_field => { "logstash-step" => "1002_tagged_by_source" }

    }
  }

  if "http_eth" in [source] {
    mutate {
      replace => { 
        "type" => "bro_http" 
      }

# Only need to track logstash step in dev, disabled in prod
#      add_field => { "logstash-step" => "1002_tagged_by_source" }

    }
  }

  if "notice.log" in [source] {
    mutate {
      replace => { 
        "type" => "bro_notice" 
      }

# Only need to track logstash step in dev, disabled in prod
#      add_field => { "logstash-step" => "1002_tagged_by_source" }

    }
  }

  if "ssl.log" in [source] {
    mutate {
      replace => { 
        "type" => "bro_ssl" 
      }

# Only need to track logstash step in dev, disabled in prod
#      add_field => { "logstash-step" => "1002_tagged_by_source" }

    }
  }

  if "ssh.log" in [source] {
    mutate {
      replace => { 
        "type" => "bro_ssh" 
      }

# Only need to track logstash step in dev, disabled in prod
#      add_field => { "logstash-step" => "1002_tagged_by_source" }

    }
  }

  if "weird.log" in [source] {
    mutate {
      replace => { 
        "type" => "bro_weird" 
      }

# Only need to track logstash step in dev, disabled in prod
#      add_field => { "logstash-step" => "1002_tagged_by_source" }

    }
  }

  if "x509.log" in [source] {
    mutate {
      replace => { 
        "type" => "bro_x509" 
      }

# Only need to track logstash step in dev, disabled in prod
#      add_field => { "logstash-step" => "1002_tagged_by_source" }

    }
  }

}
